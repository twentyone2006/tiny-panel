<!-- 顶部导航栏 -->
<nav class="navbar navbar-expand-md navbar-dark bg-primary fixed-top">
    <div class="container-fluid">
        <a class="navbar-brand" href="{{ url_for('dashboard.home') }}">
            <i class="fas fa-server mr-2"></i>Tiny Panel
        </a>
        
        <!-- 移动端菜单按钮 -->
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="切换导航">
            <span class="navbar-toggler-icon"></span>
        </button>
        
        <!-- 导航菜单 -->
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <!-- 左侧菜单（仅登录后显示） -->
            {% if current_user.is_authenticated %}
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item {% if request.endpoint.startswith('dashboard.') %}active{% endif %}">
                        <a class="nav-link" href="{{ url_for('dashboard.home') }}">
                            <i class="fas fa-tachometer-alt mr-1"></i>仪表盘
                        </a>
                    </li>
                    <li class="nav-item dropdown {% if request.endpoint.startswith('websites.') %}active{% endif %}">
                        <a class="nav-link dropdown-toggle" href="#" id="websitesDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas fa-globe mr-1"></i>网站
                        </a>
                        <div class="dropdown-menu" aria-labelledby="websitesDropdown">
                            <a class="dropdown-item" href="{{ url_for('websites.website_manager') }}">网站列表</a>
                            <a class="dropdown-item" href="{{ url_for('websites.create_website') }}">创建网站</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown {% if request.endpoint.startswith('databases.') %}active{% endif %}">
                        <a class="nav-link dropdown-toggle" href="#" id="databasesDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas fa-database mr-1"></i>数据库
                        </a>
                        <div class="dropdown-menu" aria-labelledby="databasesDropdown">
                            <a class="dropdown-item" href="{{ url_for('databases.list') }}">数据库列表</a>
                            <a class="dropdown-item" href="{{ url_for('databases.create') }}">创建数据库</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown {% if request.endpoint.startswith('files.') %}active{% endif %}">
                        <a class="nav-link dropdown-toggle" href="#" id="filesDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas fa-folder mr-1"></i>文件
                        </a>
                        <div class="dropdown-menu" aria-labelledby="filesDropdown">
                            <a class="dropdown-item" href="{{ url_for('files.manager') }}">文件管理器</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown {% if request.endpoint.startswith('software.') %}active{% endif %}">
                        <a class="nav-link dropdown-toggle" href="#" id="softwareDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas fa-cubes mr-1"></i>软件
                        </a>
                        <div class="dropdown-menu" aria-labelledby="softwareDropdown">
                            <a class="dropdown-item" href="{{ url_for('software.list') }}">软件列表</a>
                            <a class="dropdown-item" href="{{ url_for('software.installed') }}">已安装软件</a>
                        </div>
                    </li>
                    <li class="nav-item {% if request.endpoint.startswith('monitor.') %}active{% endif %}">
                        <a class="nav-link" href="{{ url_for('monitor.status') }}">
                            <i class="fas fa-chart-line mr-1"></i>监控
                        </a>
                    </li>
                    <li class="nav-item {% if request.endpoint.startswith('security.') %}active{% endif %}">
                        <a class="nav-link" href="{{ url_for('security.firewall') }}">
                            <i class="fas fa-shield-alt mr-1"></i>安全
                        </a>
                    </li>
                </ul>
            {% endif %}
            
            <!-- 右侧用户菜单 -->
            <ul class="navbar-nav ml-auto">
                {% if current_user.is_authenticated %}
                    <!-- 通知图标 -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="notificationsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas fa-bell"></i>
                            <span class="badge badge-danger">3</span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="notificationsDropdown">
                            <h6 class="dropdown-header">通知</h6>
                            <a class="dropdown-item" href="#">
                                <i class="fas fa-exclamation-triangle text-warning mr-2"></i>服务器CPU使用率过高
                            </a>
                            <a class="dropdown-item" href="#">
                                <i class="fas fa-check-circle text-success mr-2"></i>网站已成功创建
                            </a>
                            <a class="dropdown-item" href="#">
                                <i class="fas fa-times-circle text-danger mr-2"></i>数据库备份失败
                            </a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#">查看所有通知</a>
                        </div>
                    </li>
                    
                    <!-- 用户信息 -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <img src="{{ url_for('static', filename='profile_pics/' + current_user.avatar) }}" alt="用户头像" class="rounded-circle mr-2" style="width: 30px; height: 30px; object-fit: cover;">
                            {{ current_user.username }}
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
                            <a class="dropdown-item" href="{{ url_for('users.account') }}">
                                <i class="fas fa-user mr-2"></i>账户设置
                            </a>
                            {% if current_user.role == 'admin' %}
                                <a class="dropdown-item" href="{{ url_for('users.admin_users') }}">
                                    <i class="fas fa-users-cog mr-2"></i>用户管理
                                </a>
                            {% endif %}
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="{{ url_for('users.logout') }}">
                                <i class="fas fa-sign-out-alt mr-2"></i>退出登录
                            </a>
                        </div>
                    </li>
                {% else %}
                    <!-- 未登录状态 -->
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('users.login') }}">登录</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('users.register') }}">注册</a>
                    </li>
                {% endif %}
            </ul>
        </div>
    </div>
</nav>